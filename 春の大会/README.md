# 春の大会 - 使い方

春の大会向けのデータ取得・データ出力を行う Python ツール集です。

## 前提
- ルートフォルダのREADMEに従い、事前準備（環境構築）を済ませていることを前提とします。

## セットアップ
- 入手済のGoogle認証ファイルをこのフォルダに配置してください。

## サブフォルダの説明
- `DownloadTSV/`：各団体が記入したGoogleシートが、手順2によってこのフォルダにTSV形式でダウンロードされます。
- `BookletFiles/`：手順3によって、このフォルダに大会参加選手のEXCELフォーマットファイルが出力されます。
- `TournamentFiles/`：手順5によって、このフォルダにトーナメント表が出力されます。

## 操作手順
1. GoogleシートURLを出力する  
 この操作では、各団体が記入を行うGoogleシートのURL、および、集計結果/テンプレート/記入例のGoogleシートURLを出力します。  
 出力結果を、大会参加係員/選手の記入を行うURLとして各団体に連絡してください。  
 （コマンドプロンプトで以下を入力してリターンキーを押します。）  

    python 01_PrintURL.py  

2. GoogleシートをTSVファイルフォーマットでダウンロードする  
 この操作では、全団体のGoogleシートをTSVファイルフォーマットでダウンロードします。  
 ダウンロードしたTSVファイルは、後の操作手順で出力するデータの元となります。  
 （コマンドプロンプトで以下を入力してリターンキーを押します。）  

    python 02_DownloadTSV.py

3. 選手を集計する  
 この操作では、ダウンロード済のTSVファイルを元に、大会参加選手を集計します。  
 結果は、集計結果GoogleシートのURL（操作手順1を参照）、および、サブフォルダ「BookletFiles」に出力されます。  
 （コマンドプロンプトで以下を入力してリターンキーを押します。）  

    python 03_SumPlayer.py  

4. 係員を集計する  
 この操作では、ダウンロード済のTSVファイルを元に、大会係員を集計します。  
 結果は、集計結果GoogleシートのURL（操作手順1を参照）に出力されます。  
 （コマンドプロンプトで以下を入力してリターンキーを押します。）  

    python 04_SumStaff.py  

5. トーナメント表を出力する  
 この操作では、ダウンロード済のTSVファイルを元に、サブフォルダ「TournamentFiles」にトーナメント表を出力します。  
 必要に応じて、事前に 05_CreateTournament.py 最後尾の「seed」変数を設定してください。この変数は、抽選結果内容と紐づく「抽選結果番号」として使用できます。  
 この「抽選結果番号」の機能は、例えば、以下のように活用することができます。  
 ・抽選結果番号の決定を抽選直前に行うことによって、抽選結果の公平性担保に利用する。  
 ・操作担当者と抽選結果番号決定者を分けることによって、抽選結果の公平性担保に利用する。  
 ・本抽選前に、別の抽選結果番号によって「テスト抽選」を行うことによって、正常動作確認のために利用する。  
 （コマンドプロンプトで以下を入力してリターンキーを押します。）  

    python 05_CreateTournament.py  

## 操作手順(要注意)
0. 各団体のGoogleシートを再作成（初期化）する  
 この操作では、各団体が記入を行うGoogleシートを再作成（初期化）します。通常は、大会業務中の操作手順1の事前に一度だけ実施します。  
 再作成の元となるのは、テンプレートGoogleシート（操作手順1を参照）です。大会部門の増減や段位制限の変更時等、必要に応じ、事前にテンプレートGoogleシートを修正しておいてください。  
 各団体の記入は全て抹消されますので、操作には十分に注意してください。必要に応じ、操作前に各団体用Googleシートをバックアップするなどの対策を行ってください。  
 （コマンドプロンプトで以下を入力してリターンキーを押します。）  

   python XX_RemakeFiles.py  


